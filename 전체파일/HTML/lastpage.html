<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°˜ë ¤ë™ë¬¼ ì¶”ëª¨ ê³µê°„</title>
    <!-- Tailwind CSS ë° Google Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Nanum+Myeongjo:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- CSS íŒŒì¼ ë¶„ë¦¬ -->
    <link rel="stylesheet" href="../CSS/common.css">
    <link rel="stylesheet" href="../CSS/lastpagee.css">
</head>
<body>
    <!-- ê³µí†µ í—¤ë” (ìˆ˜ì •í•˜ì§€ ì•ŠìŒ) -->
    <div class="header-wrapper">
        <!-- í—¤ë” -->
        <header>
            <div class="logo">
                <a href="#"><img src="../Asset/LastPageë¡œê³ _íˆ¬ëª….png" alt="ë¡œê³ " /></a>
            </div>
            <nav>
                <ul>
                    <li>
                        <a href="#">í™ˆ</a>
                        <ul>
                            <li><a href="#">ì¸ì‚¬ë§</a></li>
                        </ul>
                    </li>

                    <li><a href="#">ì¥ë¡€ì„œë¹„ìŠ¤</a></li>
                    <li><a href="#">Ourpage</a></li>
                    <li>
                        <a href="#">ì‹¬ë¦¬ìƒë‹´</a>
                        <ul>
                            <li><a href="#">ìƒë‹´ì˜ˆì•½</a></li>
                            <li><a href="#">ì˜ˆì•½ì¡°íšŒ</a></li>
                        </ul>
                    </li>

                    <li>
                        <a href="#">ì¶”ëª¨êµ¿ì¦ˆ</a>
                        <ul>
                            <li><a href="#">êµ¿ì¦ˆì†Œê°œ</a></li>
                            <li><a href="#">êµ¿ì¦ˆì˜ˆì•½</a></li>
                            <li><a href="#">ì˜ˆì•½ì¡°íšŒ</a></li>
                        </ul>
                    </li>
                    <li><a href="#">ë§ˆì´í˜ì´ì§€</a></li>
                    <li><a href="#">ê³ ê°ì„¼í„°</a></li>
                </ul>
            </nav>
            <div class="auth">
                <a href="#">ë¡œê·¸ì¸</a>
                <a href="#">íšŒì›ê°€ì…</a>
            </div>
        </header>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content-wrapper">
        <section class="banner" role="img" aria-label="ë°¤í•˜ëŠ˜ì˜ ë³„ì„ ë°°ê²½ìœ¼ë¡œ í•œ ì¶”ëª¨ ë°°ë„ˆ">
            <div class="inner">
                <h1>ë³„ì´ ëœ ì•„ì´ë“¤ì„ ê¸°ì–µí•˜ëŠ” ê³µê°„</h1>
                <p>ë°˜ë ¤ë™ë¬¼ê³¼ì˜ ë§ˆì§€ë§‰ ì—¬ì •ì„ í•¨ê»˜ ê¸°ì–µí•©ë‹ˆë‹¤.</p>
            </div>
        </section>
        
        <section class="grid-section">
            <div id="overlay"></div>
            <div class="grid grid-cols-3 gap-8 p-4 rounded-lg w-full max-w-7xl mx-auto">
                <!-- JavaScriptë¡œ ë™ì ìœ¼ë¡œ ìƒì„± -->
            </div>
        </section>
    </main>


    <footer>
        ëŒ€ì¶© ì—°ë½ì²˜ / GitHub ì£¼ì†Œ / ì´ë©”ì¼ ë“± ì…ë ¥ ì˜ˆì •/ í‘¸í„° ë†’ì´ëŠ” í—¤ë” ë°°ë„ˆ ë°˜ì‘ í…ŒìŠ¤íŠ¸ìš©.
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const gridContainer = document.querySelector('.grid');
            const overlay = document.getElementById('overlay');
            let activeClone = null;
            let originalItem = null;
            let isAnimating = false;

            const totalItems = 12; // 3x4 ê·¸ë¦¬ë“œ
            const itemData = [
                { name: 'ì´ˆì½”', message: 'ìš°ë¦¬ ì§‘ ê·€ì—¼ë‘¥ì´, ë³„ì´ ë˜ì–´ ë°˜ì§ì—¬ì¤˜.', date: '2010.05.01 ~ 2024.03.15', isOccupied: true, photoSrc: 'https://placehold.co/300x400/d2b48c/ffffff?text=CHOCO' },
                { name: 'ë‚˜ë¹„', message: 'ë”°ëœ»í•œ í–‡ì‚´ ê°™ë˜ ë„ˆë¥¼ ê¸°ì–µí•´.', date: '2018.07.20 ~ 2023.12.10', isOccupied: true, photoSrc: null },
                { name: 'í•´í”¼', message: 'ë„ˆì™€ í•¨ê»˜í•œ ëª¨ë“  ë‚ ì´ í–‰ë³µí–ˆì–´.', date: '2012.01.11 ~ 2024.01.02', isOccupied: true, photoSrc: 'https://placehold.co/300x400/a9a9a9/ffffff?text=HAPPY' },
                { isOccupied: false },
                { name: 'ì½”ì½”', message: 'ì„¸ìƒì—ì„œ ê°€ì¥ ìš©ê°í–ˆë˜ ì‘ì€ ì²œì‚¬', date: '2020.02.02 ~ 2024.04.01', isOccupied: true, photoSrc: null },
                { isOccupied: false },
                { isOccupied: false },
                { name: 'ë£¨ì´', message: 'ì¥ë‚œê¾¸ëŸ¬ê¸° ì™•ìë‹˜, ê·¸ê³³ì—ì„  ì•„í”„ì§€ë§ˆ.', date: '2015.06.10 ~ 2024.05.20', isOccupied: true, photoSrc: 'https://placehold.co/300x400/778899/ffffff?text=LOUIE' },
                { isOccupied: false },
                { isOccupied: false },
                { name: 'ë³´ë¦¬', message: 'ë³´ë¦¬ë³´ë¦¬ìŒ€! ë„ˆì˜ ë…¸ë˜ê°€ ê·¸ë¦¬ì›Œ.', date: '2019.11.01 ~ 2024.06.30', isOccupied: true, photoSrc: null },
                { isOccupied: false },
            ];

            function expandItem(item) {
                if (isAnimating) return;
                isAnimating = true;

                originalItem = item;
                const rect = item.getBoundingClientRect();
                
                activeClone = item.cloneNode(true);
                activeClone.classList.add('expanded-clone');
                document.body.appendChild(activeClone);

                activeClone.style.position = 'fixed';
                activeClone.style.left = `${rect.left}px`;
                activeClone.style.top = `${rect.top}px`;
                activeClone.style.width = `${rect.width}px`;
                activeClone.style.height = `${rect.height}px`;
                activeClone.style.transform = 'none';

                originalItem.classList.add('is-expanding');
                overlay.classList.add('active');

                requestAnimationFrame(() => {
                    const centerX = window.innerWidth / 2;
                    const centerY = window.innerHeight / 2;
                    
                    activeClone.style.left = `${centerX}px`;
                    activeClone.style.top = `${centerY}px`;
                    activeClone.style.width = `min(60vw, 750px)`;
                    activeClone.style.height = `auto`;
                    activeClone.style.transform = `translate(-50%, -50%)`;
                });
                
                setTimeout(() => { isAnimating = false; }, 600);

                activeClone.querySelector('.close-btn').onclick = (e) => {
                    e.stopPropagation();
                    collapseItem();
                };

                // 1) ì‚¬ì§„ ì—…ë¡œë“œ ì˜¤ë¥˜ í•´ê²°: ë³µì œëœ ìš”ì†Œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë‹¤ì‹œ ì—°ê²°í•©ë‹ˆë‹¤.
                const photoInput = activeClone.querySelector('.photo-input');
                if (photoInput) {
                    photoInput.addEventListener('change', (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                const img = activeClone.querySelector('.photo-img');
                                const label = activeClone.querySelector('.photo-upload-label');
                                img.src = event.target.result;
                                img.classList.remove('hidden');
                                label.classList.add('hidden');
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                }
            }

            function collapseItem() {
                if (isAnimating || !activeClone) return;
                isAnimating = true;

                const rect = originalItem.getBoundingClientRect();
                
                activeClone.querySelector('.expanded-content').style.opacity = 0;
                activeClone.querySelector('.item-content-preview').style.opacity = 1;
                activeClone.querySelector('.glass-door').style.transform = 'rotateY(0deg)';

                setTimeout(() => {
                    activeClone.style.left = `${rect.left}px`;
                    activeClone.style.top = `${rect.top}px`;
                    activeClone.style.width = `${rect.width}px`;
                    activeClone.style.height = `${rect.height}px`;
                    activeClone.style.transform = 'none';
                }, 50);

                overlay.classList.remove('active');

                setTimeout(() => {
                    if(activeClone) activeClone.remove();
                    if(originalItem) originalItem.classList.remove('is-expanding');
                    activeClone = null;
                    originalItem = null;
                    isAnimating = false;
                }, 650);
            }

            for (let i = 0; i < totalItems; i++) {
                const item = document.createElement('div');
                item.className = 'grid-item';
                const data = itemData[i % itemData.length] || { isOccupied: false };
                
                const glassDoor = document.createElement('div');
                glassDoor.className = 'glass-door';
                glassDoor.innerHTML = `<div class="door-handle"></div>`;

                const itemContentPreview = document.createElement('div');
                itemContentPreview.className = 'item-content-preview';

                const expandedContent = document.createElement('div');
                expandedContent.className = 'expanded-content';
                
                const closeBtn = document.createElement('div');
                closeBtn.className = 'close-btn';
                closeBtn.innerHTML = '&times;';

                if (data.isOccupied) {
                    item.appendChild(Object.assign(document.createElement('span'), { className: 'flower-indicator', textContent: 'ğŸ’®' }));
                    itemContentPreview.innerHTML = `<div class="w-full h-full flex items-end justify-around opacity-70"><div class="urn-preview"></div><div class="photo-frame-preview"></div></div>`;
                    expandedContent.innerHTML = `
                        <div class="top-details">
                            <h2 class="text-3xl font-bold mb-2 font-nanum flex items-center justify-center gap-2">
                                <span>${data.name}</span>
                                <span class="text-2xl" style="line-height: 1;">ğŸ’®</span>
                            </h2>
                            <p class="text-gray-600 mb-2 text-base">"${data.message}"</p>
                            <p class="text-sm text-gray-500">${data.date}</p>
                        </div>
                        <div class="scene-container">
                            <div class="scene-background">
                                <div class="urn"></div>
                                <div class="photo-frame">
                                    <div class="photo-display">
                                        <img class="photo-img ${data.photoSrc ? '' : 'hidden'}" src="${data.photoSrc || ''}" alt="${data.name}ì˜ ì‚¬ì§„">
                                        <label class="photo-upload-label ${data.photoSrc ? 'hidden' : 'flex'}">
                                            <input type="file" accept="image/*" class="hidden photo-input">
                                            <span>ğŸ–¼ï¸</span>
                                            <span>ëŒ€í‘œ ì‚¬ì§„ ì„¤ì •í•˜ê¸°</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="goods-selector">
                                <div class="goods-item" title="í„¸ì‹¤ êµ¿ì¦ˆ"><svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 0 0-7.5 16.5M12 22a10 10 0 0 0 7.5-16.5M2 12h20M12 2a14 14 0 0 0-4 2.5M12 22a14 14 0 0 1 4-2.5M12 2a14 14 0 0 1 4 2.5M12 22a14 14 0 0 0-4-2.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>
                                <div class="goods-item" title="ë°˜ì§€ êµ¿ì¦ˆ"><svg viewBox="0 0 24 24"><path d="M12 21a9 9 0 0 0-9-9 9 9 0 0 0 9-9 9 9 0 0 0 9 9 9 9 0 0 0-9 9zM10.5 8.5l3 3" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>
                                <div class="goods-item" title="ëª©ê±¸ì´ êµ¿ì¦ˆ"><svg viewBox="0 0 24 24"><path d="M12 22a7 7 0 0 0 7-7V9a2 2 0 0 0-2-2h-1a2 2 0 0 0-2 2v1a2 2 0 0 0 2 2h1M12 22a7 7 0 0 1-7-7V9a2 2 0 0 1 2-2h1a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-1" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="12" cy="16" r="3"></circle></svg></div>
                            </div>
                        </div>`;
                } else {
                    itemContentPreview.classList.add('empty-slot');
                    itemContentPreview.innerHTML = `<div class="text-gray-600 font-nanum text-lg">ë¹ˆ ìë¦¬</div>`;
                    expandedContent.innerHTML = `<div class="flex flex-col items-center justify-center h-full">
                        <h2 class="text-3xl font-bold mb-4 font-nanum">ë¹ˆ ìë¦¬</h2>
                        <p class="text-gray-600 text-center">ì´ ìë¦¬ëŠ” í˜„ì¬ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.<br>ìƒˆë¡œìš´ ì•ˆì‹ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.</p>
                        <button class="reserve-btn">ì˜ˆì•½í•˜ê¸°</button>
                        </div>`;
                }
                expandedContent.prepend(closeBtn);
                item.append(glassDoor, itemContentPreview, expandedContent);
                gridContainer.appendChild(item);

                item.addEventListener('click', () => {
                    if (activeClone || isAnimating) return;
                    expandItem(item);
                });
            }

            overlay.addEventListener('click', () => {
                if (activeClone) {
                    collapseItem();
                }
            });
        });
    </script>
</body>
</html>
