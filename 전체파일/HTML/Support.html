<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <link rel="stylesheet" href="../CSS/common.css">
    <link rel="stylesheet" href="../HTML/common.html">
  <title>ê³ ê°ì„¼í„°</title>
  <style>
    :root{
      --bg:#f6f5f2;
      --panel:#ffffff;
      --ink:#2C3930;           
      --muted:#6c7a72;
      --brand:#2C3930;     
      --accent:#A27b5c;     
      --soft:#ebedea;
      --border:#e8e3dc;
      --shadow:0 14px 40px rgba(0,0,0,.12);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0}
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Apple SD Gothic Neo,Arial,sans-serif;
      color:var(--ink);
      background:var(--bg);
      line-height:1.5;
    }

    /* ë°°ë„ˆ */
    .banner{
      position:relative;
      min-height:44vh;
      display:grid;
      place-items:center;
      color:#fff;
      text-align:center;
      overflow:hidden;
      background:#0f201a;
      isolation:isolate;
    }
    .banner::before{
      content:"";
      position:absolute;inset:0;
      background:url('https://images.unsplash.com/photo-1561037404-61cd46aa615b?q=80&w=2600&auto=format&fit=crop') center/cover no-repeat;
      filter:grayscale(.1) saturate(.7) brightness(.8);
      z-index:-2;
    }
    .banner::after{
      content:"";position:absolute;inset:0;
      background:linear-gradient(180deg, rgba(33,55,47,.72), rgba(33,55,47,.65));
      z-index:-1;
    }
    .banner .inner{max-width:1100px;padding:64px 20px 86px}
    .headline{font-weight:800;letter-spacing:-.02em;margin:0 0 10px;font-size:clamp(28px,4.5vw,48px)}
    .sub{opacity:.92;font-size:clamp(14px,1.8vw,18px);margin:0 auto;max-width:800px}

    /* ë²„íŠ¼ */
    .btn{appearance:none;border:1px solid transparent;background:#A27b5c;color:#fff;border-radius:999px;padding:10px 18px;cursor:pointer;font-weight:700;box-shadow:0 6px 18px rgba(33,55,47,.18);transition:.2s transform,.2s box-shadow}
    .btn:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(33,55,47,.22)}
    .btn-outline{background:#A27b5c;color:#fff;border-color:#A27b5c;}
    .btn-ghost{background:transparent;border-color:var(--border);color:var(--ink)}

    /* ë ˆì´ì•„ì›ƒ */
    .wrap{max-width:1100px;margin:0 auto;padding:0 16px 80px}

    /* íƒ­ */
    .tabbar{display:flex;gap:8px;margin:24px 0 12px;align-items:center}
    .tab{padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;cursor:pointer;font-weight:700;color:var(--muted)}
    .tab.active{color:var(--brand);border-color:#c9cfc9;box-shadow:var(--shadow)}
    
  
    .tabbar .ask-btn{
  margin-left: auto;       
  padding: 10px 14px;     
  border-radius: 12px;     
  height: auto;            
}

    /* FAQ ì•„ì½”ë””ì–¸ */
    .faq-list{display:grid;gap:10px}
    .item{background:var(--panel);border:1px solid var(--border);border-radius:14px;overflow:hidden}
    .q{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:16px 18px;cursor:pointer}
    .q .left{display:flex;align-items:center;gap:10px}
    .badge{background:var(--soft);color:var(--brand);font-weight:800;border-radius:8px;padding:4px 8px;font-size:12px}
    .q .caret{transition:transform .2s ease}
    .a{padding:0 18px 16px 46px;color:#2e3833;display:none}
    .item.open .a{display:block; border-top: 1px solid gainsboro; background-color: #2C3930; color: #fff;}
    .item.open .q .caret{transform:rotate(90deg)}

    /* í˜ì´ì§€ë„¤ì´ì…˜ */
    .pager{display:flex;gap:8px;justify-content:center;margin:22px 0 8px}
    .page-btn{min-width:36px;height:36px;padding:0 12px;border-radius:10px;border:1px solid #A27b5c;background:#fff;cursor:pointer;color:#A27b5c;}
    .page-btn.active{background:#A27b5c;color:#fff;border-color:transparent}

    /* í€µ ë°” */
    .quickbar{display:flex;gap:12px;align-items:center;justify-content:space-between;margin:10px 0 22px}
    .left-actions{display:flex;gap:8px;align-items:center}

    /* QnA ë¦¬ìŠ¤íŠ¸ */
    .qna-list{display:grid;gap:10px}
    .post{background:#fff;border:1px solid var(--border);border-radius:14px;overflow:hidden}
    .post-head{padding:14px 16px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .post-title{font-weight:700}
    .meta{font-size:12px;color:var(--muted)}
    .post-body{padding:0 16px 16px 16px;display:none}
    .post.open .post-body{display:block}
    .tag{background:var(--soft);color:var(--brand);padding:2px 8px;border-radius:999px;font-size:12px;font-weight:700}
    .chips{display:flex;gap:6px;align-items:center}

    /* ëª¨ë‹¬ */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(18,22,20,.55);padding:20px;z-index:50}
    .modal.open{display:grid}
    .sheet{width:min(920px,100%);max-height:90vh;overflow:auto;background:#fff;border-radius:18px;box-shadow:var(--shadow)}
    .sheet-head{padding:16px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
    .sheet-body{padding:18px}
    .grid{display:grid;gap:14px}
    .row{display:grid;gap:8px}
    label{font-weight:700}
    input,select,textarea{width:100%;border:1px solid #dcd8d1;border-radius:12px;padding:12px 12px;background:#fff;font:inherit}
    textarea{min-height:150px;resize:vertical}
    .hint{font-size:12px;color:var(--muted)}
    .field-inline{display:flex;flex-direction:row;align-items:center;gap:0px;flex-wrap:nowrap}
    .row.field-inline{display:flex;align-items:center;gap:2px}
    label.field-inline{display:inline-flex;align-items:center;gap:1px;white-space:nowrap}
    .row.field-inline input[type="checkbox"]{margin-right:0;}
    .files{display:flex;flex-wrap:wrap;gap:8px}
    .preview{width:84px;height:84px;border-radius:12px;object-fit:cover;border:1px solid var(--border)}

    .toolbar{display:flex;gap:8px;align-items:center}
    .danger{background:#8d2f2f}

    @media (max-width:968px){
      .q{padding:14px}
      .a{padding:0 14px 14px 42px}
      .post-head{flex-direction:column;align-items:flex-start;gap:6px}
      .tabbar{flex-wrap:wrap}
    }
  </style>
</head>
<body>
  <!-- ë°°ë„ˆ -->
  <section class="banner" aria-labelledby="bannerTitle">
    <div class="inner">
      <h1 id="bannerTitle" class="headline">íƒ€ì´í‹€ ì£¼ì œ ì ê¸°</h1>
      <p class="sub">1. QnAì°½ ë²„íŠ¼, chipsì‚¬ì´ì¦ˆ ë‹¤ì‹œ êµ¬í˜„ <br/>2. ì§ˆë¬¸ ì‘ì„± í˜ì´ì§€ ë²„íŠ¼, ì²´í¬ë°•ìŠ¤ ì‚¬ì´ì§•, ë¶„ë¥˜ ì‚¬ì´ë“œ ë“œë¡­ ìŠ¤í¬ë¡¤ ë””ìì¸</p>

    </div>
  </section>

  <!-- íƒ­ + ì§ˆë¬¸í•˜ê¸° (ìƒë‹¨ ì»¨íŠ¸ë¡¤ ë°”ëŠ” ì œê±°) -->
  <main class="wrap">
    <div class="tabbar" role="tablist" aria-label="ì½˜í…ì¸  ì „í™˜">
      <button class="tab active" id="tab-faq" role="tab" aria-selected="true">FAQ</button>
      <button class="tab" id="tab-qna" role="tab" aria-selected="false">QnA</button>
     <button class="btn ask-btn" id="btnAsk">ì§ˆë¬¸í•˜ê¸°</button>
    </div>

    <!-- FAQ ì„¹ì…˜ -->
    <section id="faqSection" aria-labelledby="faqTitle">
      <h2 id="faqTitle" class="sr-only" style="position:absolute;left:-9999px">ìì£¼í•˜ëŠ” ì§ˆë¬¸</h2>
      <div id="faqList" class="faq-list"></div>
      <div class="pager" id="faqPager"></div>
    </section>

    <!-- QnA ì„¹ì…˜ -->
    <section id="qnaSection" hidden aria-labelledby="qnaTitle">
      <h2 id="qnaTitle" class="sr-only" style="position:absolute;left:-9999px">QnA</h2>
      <div class="quickbar">
        <div class="chips">
          <span class="tag">ì „ì²´</span>
          <select id="qnaFilter" title="ë¶„ë¥˜ í•„í„°">
            <option value="ALL">ì „ì²´</option>
            <option>ì¥ë¡€ì„œë¹„ìŠ¤</option>
            <option>ì‹¬ë¦¬ìƒë‹´ì„œë¹„ìŠ¤</option>
            <option>êµ¿ì¦ˆì„œë¹„ìŠ¤</option>
            <option>ì»¤ë®¤ë‹ˆí‹°ì„œë¹„ìŠ¤</option>
            <option>ì¶”ëª¨ê³µê°„ì„œë¹„ìŠ¤</option>
          </select>
        </div>
        <div class="chips">
          <input id="qnaSearch" placeholder="ì œëª©/ë‚´ìš© ê²€ìƒ‰" style="max-width:260px">
          <button class="btn-ghost" id="btnQnaRefresh">ìƒˆë¡œê³ ì¹¨</button>
        </div>
      </div>
      <div id="qnaList" class="qna-list"></div>
    </section>
  </main>

  <!-- ì§ˆë¬¸ ì‘ì„± ëª¨ë‹¬ -->
  <div class="modal" id="askModal" aria-hidden="true" aria-label="ì§ˆë¬¸ ì‘ì„±">
    <div class="sheet">
      <div class="sheet-head">
        <strong>ì§ˆë¬¸í•˜ê¸°</strong>
        <div class="toolbar">
          <button class="btn-ghost" id="btnCloseAsk">ë‹«ê¸°</button>
        </div>
      </div>
      <div class="sheet-body">
        <form id="askForm" class="grid">
          <div class="row">
            <label for="title">ì œëª© <span class="hint">(í•„ìˆ˜)</span></label>
            <input id="title" required maxlength="100" placeholder="ì˜ˆ) ê°œë³„ í™”ì¥ ì§„í–‰ ì ˆì°¨ê°€ ê¶ê¸ˆí•©ë‹ˆë‹¤" />
          </div>
          <div class="row field-inline">
            <div style="flex:1">
              <label for="category">ë¶„ë¥˜</label>
              <select id="category" required>
                <option value="ì¥ë¡€ì„œë¹„ìŠ¤">ì¥ë¡€ì„œë¹„ìŠ¤</option>
                <option value="ì‹¬ë¦¬ìƒë‹´ì„œë¹„ìŠ¤">ì‹¬ë¦¬ìƒë‹´ì„œë¹„ìŠ¤</option>
                <option value="êµ¿ì¦ˆì„œë¹„ìŠ¤">êµ¿ì¦ˆì„œë¹„ìŠ¤</option>
                <option value="ì»¤ë®¤ë‹ˆí‹°ì„œë¹„ìŠ¤">ì»¤ë®¤ë‹ˆí‹°ì„œë¹„ìŠ¤</option>
                <option value="ì¶”ëª¨ê³µê°„ì„œë¹„ìŠ¤">ì¶”ëª¨ê³µê°„ì„œë¹„ìŠ¤</option>
              </select>
            </div>
            <div style="flex:1">
              <label for="nickname">ì‘ì„±ì (ë‹‰ë„¤ì„)</label>
              <input id="nickname" placeholder="ì˜ˆ) í•´í”¼ì—„ë§ˆ" />
            </div>
            <div style="flex:1">
              <label for="writerPass">ìˆ˜ì •/ì‚­ì œ ë¹„ë°€ë²ˆí˜¸ <span class="hint">(í•„ìˆ˜, 4~12ì)</span></label>
              <input id="writerPass" type="password" minlength="4" maxlength="12" required />
            </div>
          </div>
          <div class="row">
            <label for="content">ë‚´ìš©</label>
            <textarea id="content" required placeholder="ìì„¸í•œ ìƒí™©ì´ë‚˜ ê¶ê¸ˆí•œ ì ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
          </div>
          <div class="row">
            <label>ì‚¬ì§„ ì²¨ë¶€ <span class="hint">(ìµœëŒ€ 3ì¥, ì¥ë‹¹ 2MB ì´í•˜)</span></label>
            <input id="photos" type="file" accept="image/*" multiple />
            <div id="previews" class="files"></div>
          </div>
          <div class="row">
            <label>ë§í¬ ì²¨ë¶€</label>
            <div id="linkBox" class="grid"></div>
            <div class="toolbar">
              <button type="button" class="btn-ghost" id="btnAddLink">ë§í¬ ì¶”ê°€</button>
            </div>
          </div>
          <div class="row field-inline">
            <label class="field-inline" ><input type="checkbox" id="secret"> ë¹„ê³µê°œë¡œ ë“±ë¡</label>
            <span class="hint"></span>
          </div>
          <div class="row field-inline" style="justify-content:flex-end">
            <button class="btn btn-outline" type="reset">ì´ˆê¸°í™”</button>
            <button class="btn" type="submit" id="btnSubmit">ë“±ë¡í•˜ê¸°</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // ---------- ë°ì´í„° ì…‹ì—… (FAQ ë”ë¯¸) ----------
    const defaultFaq = [
      { q:"ë°˜ë ¤ë™ë¬¼ ì¥ë¡€ë€ ë¬´ì—‡ì¸ê°€ìš”?", a:"ì¥ë¡€ëŠ” ê³ ì¸ì˜ ì¡´ì—„ì„ ì§€í‚¤ë©° ë§ˆì§€ë§‰ ì‹œê°„ì„ ì˜ˆì˜ë¥¼ ê°–ì¶° ë³´ë‚´ëŠ” ì ˆì°¨ì…ë‹ˆë‹¤. ì¢…í•© ìƒë‹´, ìš´êµ¬, ì‘ë³„ì‹¤, í™”ì¥, ìˆ˜ê³¨, ì¶”ëª¨ê¹Œì§€ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤." },
      { q:"ì‚¬ì²´ëŠ” ì–´ë–»ê²Œ ë³´ê´€í•´ì•¼ í•˜ë‚˜ìš”?", a:"ê°€ëŠ¥í•˜ë©´ 2~3ì‹œê°„ ë‚´ ìƒë‹´ì„ ê¶Œì¥í•˜ë©°, ë°”ë¡œ ë°©ë¬¸ì´ ì–´ë ¤ìš°ë©´ ì‹œì‹ ì´ ë§ˆë¥´ì§€ ì•Šë„ë¡ ê¹¨ë—í•œ ìˆ˜ê±´ìœ¼ë¡œ ê°ì‹¸ê³  ì•„ì´ìŠ¤íŒ©ì„ ë³µë¶€ì— ëŒ€ ì£¼ì„¸ìš”." },
      { q:"ê°œë³„ í™”ì¥ê³¼ í•©ë™ í™”ì¥ì˜ ì°¨ì´ëŠ”?", a:"ê°œë³„ í™”ì¥ì€ ë°˜ë ¤ë™ë¬¼ í•œ ê°œì²´ë§Œ ë‹¨ë…ìœ¼ë¡œ ì§„í–‰í•˜ê³  ìœ ê³¨ ì „ëŸ‰ì„ ëŒë ¤ë“œë¦½ë‹ˆë‹¤. í•©ë™ í™”ì¥ì€ ì—¬ëŸ¬ ì•„ì´ê°€ í•¨ê»˜ ì§„í–‰ë˜ì–´ ìœ ê³¨ ë°˜í™˜ì´ ì—†ìŠµë‹ˆë‹¤." },
      { q:"ìœ ê³¨í•¨/ê¸°ë…í’ˆ(êµ¿ì¦ˆ) êµ¬ë§¤ê°€ ê°€ëŠ¥í•œê°€ìš”?", a:"ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì‚¬ì´ì¦ˆì™€ ì†Œì¬ì˜ ìœ ê³¨í•¨, ëª¨ë°œ/ë°œë°”ë‹¥ ëª¨ì–‘ í”„ë ˆì„, ê°ì¸ ì„œë¹„ìŠ¤ ë“±ì„ ì œê³µí•©ë‹ˆë‹¤." },
      { q:"ì‹¬ë¦¬ìƒë‹´ì€ ì–´ë–»ê²Œ ì§„í–‰ë˜ë‚˜ìš”?", a:"ìƒë‹´ì‚¬ëŠ” ìŠ¬í”” ë‹¨ê³„ í‰ê°€ì™€ ì• ë„ ê³¼ì—…ì„ ê¸°ë°˜ìœ¼ë¡œ 1:1 ë§ì¶¤ ì„¸ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ëŒ€ë©´/ë¹„ëŒ€ë©´ ëª¨ë‘ ê°€ëŠ¥í•˜ë©° ì˜ˆì•½ì œë¡œ ìš´ì˜ë©ë‹ˆë‹¤." },
      { q:"ì˜ˆì•½/ì ‘ìˆ˜ëŠ” 24ì‹œê°„ ë˜ë‚˜ìš”?", a:"ê¸´ê¸‰ ì ‘ìˆ˜ëŠ” 24ì‹œê°„ ì—°ë½ ê°€ëŠ¥í•˜ë©°, ì•¼ê°„ì—ëŠ” ëŒ€ê¸° ì‹œê°„ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
      { q:"ì£¼ì°¨ì™€ ì ‘ê·¼ì„±ì€ ì–´ë–¤ê°€ìš”?", a:"ì¥ë¡€ì‹ì¥ ë‚´ ì „ìš© ì£¼ì°¨ êµ¬ì—­ì´ ìˆìŠµë‹ˆë‹¤. ì—˜ë¦¬ë² ì´í„°/íœ ì²´ì–´ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤." },
      { q:"ìœ ê³¨ì€ ì–´ë””ì— ì•ˆì¹˜í•  ìˆ˜ ìˆë‚˜ìš”?", a:"ë‚©ê³¨ë‹¹/ìˆ˜ëª©ì¥/ê°€ì • ì•ˆì¹˜ ë“± ì—¬ëŸ¬ í˜•íƒœë¥¼ ì•ˆë‚´í•´ ë“œë¦¬ë©°, ë²•ê·œë¥¼ ì¤€ìˆ˜í•©ë‹ˆë‹¤." },
      { q:"ë¹„ìš©ì€ ì–´ë–»ê²Œ ì‚°ì •ë˜ë‚˜ìš”?", a:"ì²´ì¤‘, ì„ íƒ ì„œë¹„ìŠ¤(ê°œë³„/í•©ë™, ì—¼ìŠµ ì—¬ë¶€, ì¶”ëª¨ì‹¤ ì‚¬ìš©, êµ¿ì¦ˆ ë“±)ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ìƒì„¸ ê²¬ì ì€ ìƒë‹´ ì‹œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤." },
      { q:"ì¹´ë“œê²°ì œ/í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œê¸‰ë˜ë‚˜ìš”?", a:"ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤. í˜„ê¸ˆì˜ìˆ˜ì¦ì€ ê°œì¸/ì‚¬ì—…ì êµ¬ë¶„í•˜ì—¬ ë°œê¸‰í•©ë‹ˆë‹¤." },
      { q:"ìœ ê³¨ì„ ì•„íŒŒíŠ¸ í™”ë‹¨ì— ë¿Œë ¤ë„ ë˜ë‚˜ìš”?", a:"ê´€í•  ì§€ìì²´ ê·œì •ê³¼ ê³µë™ì£¼ê±° ê³µê°„ì˜ ê·œì•½ì„ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ìˆ˜ëª©ì¥ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤." },
      { q:"ì¶”ëª¨ê³µê°„ ì˜ˆì•½ì€ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?", a:"ëª¨ë°”ì¼ ë˜ëŠ” ì „í™”ë¡œ ì˜ˆì•½ í›„ ë°©ë¬¸í•´ ì£¼ì‹œë©´ ë©ë‹ˆë‹¤." }
    ];

    // ---------- ìƒíƒœ ----------
    const state = {
      faqPage: 1,
      faqPerPage: 8,
      editingId: null,
    };

    // ---------- ìœ í‹¸ ----------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const formatTime = (d) => new Date(d).toLocaleString('ko-KR',{hour12:false});
    const uid = () => Math.random().toString(36).slice(2)+Date.now().toString(36);

    // ---------- ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ----------
    const LS = {
      get(key, fallback){
        try{ return JSON.parse(localStorage.getItem(key)) ?? fallback }catch{ return fallback }
      },
      set(key, val){ localStorage.setItem(key, JSON.stringify(val)) }
    };

    // ì´ˆê¸° FAQ
    if(!LS.get('faqData')) LS.set('faqData', defaultFaq);

    // QnA ì €ì¥ êµ¬ì¡°
    if(!LS.get('qnaPosts')) LS.set('qnaPosts', []);

    // ---------- FAQ ë Œë” ----------
    function renderFaq(){
      const list = LS.get('faqData', []);
      const totalPages = Math.max(1, Math.ceil(list.length / state.faqPerPage));
      if(state.faqPage>totalPages) state.faqPage=totalPages;
      const start = (state.faqPage-1)*state.faqPerPage;
      const pageItems = list.slice(start, start+state.faqPerPage);
      const wrap = $('#faqList');
      wrap.innerHTML = '';
      pageItems.forEach((it)=>{
        const el = document.createElement('article');
        el.className = 'item';
        el.innerHTML = `
          <div class="q" role="button" aria-expanded="false">
            <div class="left"><span class="badge">Q</span><span>${it.q}</span></div>
            <span class="caret">â–¶</span>
          </div>
          <div class="a"><p>${it.a}</p></div>
        `;
        const btn = $('.q', el);
        btn.addEventListener('click',()=>{
          el.classList.toggle('open');
          btn.setAttribute('aria-expanded', el.classList.contains('open'));
        });
        wrap.appendChild(el);
      });
      const pager = $('#faqPager');
      pager.innerHTML = '';
      for(let i=1;i<=totalPages;i++){
        const p = document.createElement('button');
        p.className = 'page-btn'+(i===state.faqPage?' active':'');
        p.textContent=i;
        p.addEventListener('click',()=>{state.faqPage=i;renderFaq();window.scrollTo({top:0,behavior:'smooth'});});
        pager.appendChild(p);
      }
    }

    // ---------- QnA ë Œë” ----------
    function renderQna(){
      const listWrap = $('#qnaList');
      const posts = LS.get('qnaPosts', []);
      const filter = $('#qnaFilter').value;
      const kw = ($('#qnaSearch').value||'').trim();
      const filtered = posts
        .filter(p=> (filter==='ALL'||p.category===filter) && (kw===''||p.title.includes(kw)||p.content.includes(kw)) )
        .sort((a,b)=> b.createdAt - a.createdAt);

      listWrap.innerHTML = '';
      if(filtered.length===0){
        const none = document.createElement('div');
        none.className='hint';
        none.style.padding='24px';
        none.textContent='ë“±ë¡ëœ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤. ìƒë‹¨ â€œì§ˆë¬¸í•˜ê¸°â€ë¥¼ ëˆŒëŸ¬ ì²« ì§ˆë¬¸ì„ ë‚¨ê²¨ë³´ì„¸ìš”.';
        listWrap.appendChild(none);
        return;
      }

      filtered.forEach(post=>{
        const el = document.createElement('article');
        el.className='post';
        const locked = post.secret === true;
        const answerDone = !!post.answer;
        el.innerHTML = `
          <div class="post-head" role="button">
            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
              <span class="tag">${post.category}</span>
              <span class="post-title">${locked? '[ë¹„ê³µê°œ] ' : ''}${escapeHtml(post.title)}</span>
            </div>
            <div class="meta">ì‘ì„±ì: ${escapeHtml(post.nickname||'ìµëª…')} Â· ${formatTime(post.createdAt)} ${answerDone? ' Â· <span style="color:#0d7a43;font-weight:700">[ë‹µë³€ì™„ë£Œ]</span>':''}</div>
          </div>
          <div class="post-body">
            <div>
              ${locked? '<em class="hint">ë¹„ê³µê°œ ê¸€ì…ë‹ˆë‹¤. ì—´ëŒí•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</em>' : nl2br(escapeHtml(post.content))}
            </div>
            ${post.links?.length? `<div style="margin-top:10px" class="grid">${post.links.map(u=>`<a href="${u}" target="_blank" rel="noopener">ğŸ”— ${u}</a>`).join('')}</div>`:''}
            ${post.images?.length? `<div class="files" style="margin-top:10px">${post.images.map(src=>`<img class="preview" alt="ì²¨ë¶€ ì´ë¯¸ì§€" src="${src}">`).join('')}</div>`:''}

            <div class="toolbar" style="margin-top:12px; flex-wrap:wrap">
              <button class="btn-ghost" data-act="view">${locked? 'ë¹„ê³µê°œ ê¸€ ë³´ê¸°' : 'ë‚´ìš© ì ‘ê¸°'}</button>
              <button class="btn-ghost" data-act="edit">ìˆ˜ì •</button>
              <button class="btn-ghost danger" data-act="del">ì‚­ì œ</button>
            </div>

            <div class="grid" style="margin-top:10px" ${answerDone? '':'hidden'}>
              <div class="tag">ê´€ë¦¬ì ë‹µë³€</div>
              <div>${answerDone? nl2br(escapeHtml(post.answer.text)) : ''}</div>
              ${answerDone? `<div class="meta">by ${escapeHtml(post.answer.adminName||'ê´€ë¦¬ì')} Â· ${formatTime(post.answer.createdAt)}</div>`:''}
            </div>
          </div>
        `;

        const head = $('.post-head', el);
        head.addEventListener('click',()=>{ el.classList.toggle('open'); });

        // ë²„íŠ¼ í•¸ë“¤ë§
        el.addEventListener('click', (e)=>{
          const b = e.target.closest('button'); if(!b) return;
          const act = b.dataset.act;
          if(act==='view'){
            if(post.secret){
              const pw = prompt('ë¹„ê³µê°œ ê¸€ì…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
              if(pw && pw === post.password){
                const body = $('.post-body', el);
                body.querySelector('div').innerHTML = nl2br(escapeHtml(post.content));
                b.textContent = 'ë‚´ìš© ì ‘ê¸°';
              } else if(pw!==null) { alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); }
            } else {
              el.classList.remove('open');
            }
          }
          if(act==='edit'){
            const pw = prompt('ìˆ˜ì • ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
            if(pw===post.password){ openAskModal(post) } else if(pw!==null){ alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); }
          }
          if(act==='del'){
            const pw = prompt('ì‚­ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
            if(pw===post.password){ if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')){ removePost(post.id); } } else if(pw!==null){ alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); }
          }
        });

        listWrap.appendChild(el);
      });
    }

    function removePost(id){
      const posts = LS.get('qnaPosts', []);
      LS.set('qnaPosts', posts.filter(p=>p.id!==id));
      renderQna();
    }

    function savePost(post){
      const posts = LS.get('qnaPosts', []);
      const idx = posts.findIndex(p=>p.id===post.id);
      if(idx>-1) posts[idx]=post; else posts.push(post);
      LS.set('qnaPosts', posts);
    }

    // ---------- ëª¨ë‹¬/í¼ ----------
    const askModal = $('#askModal');
    $('#btnAsk').addEventListener('click', ()=> openAskModal());
    $('#btnCloseAsk').addEventListener('click', closeAskModal);

    function openAskModal(post){
      askModal.classList.add('open');
      askModal.setAttribute('aria-hidden','false');
      const linkBox = $('#linkBox'); linkBox.innerHTML=''; addLinkField(post?.links||[]);
      $('#previews').innerHTML=''; $('#photos').value='';
      if(post){
        state.editingId = post.id;
        $('#title').value = post.title;
        $('#category').value = post.category;
        $('#nickname').value = post.nickname||'';
        $('#content').value = post.content;
        $('#secret').checked = !!post.secret;
        (post.images||[]).forEach(src=>{
          const img = document.createElement('img'); img.src=src; img.className='preview'; $('#previews').append(img);
        });
      } else {
        state.editingId = null;
        $('#askForm').reset();
      }
    }
    function closeAskModal(){
      askModal.classList.remove('open');
      askModal.setAttribute('aria-hidden','true');
    }

    // ë§í¬ í•„ë“œ ë™ì  ì¶”ê°€
    $('#btnAddLink').addEventListener('click', ()=> addLinkField());
    function addLinkField(values=[]){
      const linkBox = $('#linkBox');
      const group = document.createElement('div');
      group.className='field-inline';
      group.innerHTML = `
        <input type="url" placeholder="https:// ì˜ˆ) ì°¸ê³  ë§í¬" value="${values[0]||''}" />
        <button type="button" class="btn-ghost">ì‚­ì œ</button>
      `;
      group.querySelector('button').addEventListener('click',()=> group.remove());
      linkBox.appendChild(group);
    }

    // ì´ë¯¸ì§€ í”„ë¦¬ë·° + ìš©ëŸ‰ ì²´í¬
    $('#photos').addEventListener('change', (e)=>{
      const files = Array.from(e.target.files).slice(0,3);
      const box = $('#previews'); box.innerHTML='';
      for(const f of files){
        if(f.size > 2*1024*1024){ alert('ì´ë¯¸ì§€ '+f.name+' ì´(ê°€) 2MBë¥¼ ì´ˆê³¼í•˜ì—¬ ì œì™¸ë©ë‹ˆë‹¤.'); continue; }
        const reader = new FileReader();
        reader.onload = ev => {
          const img = document.createElement('img'); img.className='preview'; img.src = ev.target.result; box.appendChild(img);
        };
        reader.readAsDataURL(f);
      }
    });

    // ì œì¶œ ì²˜ë¦¬
    $('#askForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const title = $('#title').value.trim();
      const category = $('#category').value;
      const nickname = $('#nickname').value.trim();
      const password = $('#writerPass').value;
      const content = $('#content').value.trim();
      const secret = $('#secret').checked;
      if(!title || !content || !password){ alert('ì œëª©/ë‚´ìš©/ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.'); return; }

      const links = $$('#linkBox input').map(i=>i.value.trim()).filter(Boolean);
      const images = $$('#previews img').map(img=>img.src).slice(0,3);

      const now = Date.now();
      const post = state.editingId ? LS.get('qnaPosts', []).find(p=>p.id===state.editingId) : { id: uid(), createdAt: now };
      Object.assign(post, { title, category, nickname, content, images, links, secret, password, updatedAt: now });
      savePost(post);
      closeAskModal();
      switchTab('qna');
      setTimeout(()=>{ alert('ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. QnA ëª©ë¡ì—ì„œ í™•ì¸í•˜ì„¸ìš”.'); }, 50);
    });

    // ---------- íƒ­ ----------
    function switchTab(name){
      const faqOn = name==='faq';
      $('#faqSection').hidden = !faqOn; $('#qnaSection').hidden = faqOn;
      $('#tab-faq').classList.toggle('active', faqOn); $('#tab-qna').classList.toggle('active', !faqOn);
      if(!faqOn) renderQna(); else renderFaq();
      window.scrollTo({top:0,behavior:'smooth'});
    }
    $('#tab-faq').addEventListener('click', ()=> switchTab('faq'));
    $('#tab-qna').addEventListener('click', ()=> switchTab('qna'));

    // ---------- helpers ----------
    function escapeHtml(str){ return (str||'').replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])) }
    function nl2br(str){ return (str||'').replace(/\n/g,'<br>') }

    // ì´ˆê¸° ë Œë”
    renderFaq();
  </script>
</body>
</html>
