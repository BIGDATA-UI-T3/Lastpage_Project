<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/signin.css}">

    <title>로그인</title>
</head>

<body>
<main>
    <div class="header-wrapper">
        <header>
            <div class="logo">
                <a th:href="@{/}"><img th:src="@{/asset/LastPage로고_투명.png}" alt="로고"  src=""/></a>
            </div>
            <nav>
                <ul>
                    <li>
                        <a href="#">홈</a>
                        <ul><li><a href="#">인사말</a></li></ul>
                    </li>
                    <li><a href="#">장례서비스</a></li>
                    <li><a href="#">Ourpage</a></li>
                    <li>
                        <a href="#">심리상담</a>
                        <ul>
                            <li><a href="#">상담예약</a></li>
                            <li><a href="#">예약조회</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">추모굿즈</a>
                        <ul>
                            <li><a href="#">굿즈소개</a></li>
                            <li><a href="#">굿즈예약</a></li>
                            <li><a href="#">예약조회</a></li>
                        </ul>
                    </li>
                    <li><a href="#">마이페이지</a></li>
                    <li><a href="#">고객센터</a></li>
                </ul>
            </nav>
        </header>

        <section class="banner" role="img" aria-label="추모 굿즈 간편예약 배너">
            <div class="inner">
                <h1>사랑을 형태로 남기는 맞춤 제작</h1>
                <p>유골·모발·발자국 등 소중한 흔적으로 주얼리/액자/레진 오브제를 제작합니다.</p>
            </div>
        </section>
    </div>

    <div class="wrap">
        <form class="card" id="loginForm" th:action="@{/login-process}" method="post" autocomplete="on">

            <h1 style="text-align: center;">로그인</h1>

            <div th:if="${param.error}" class="alert alert-danger" role="alert" style="text-align:center;">
                아이디 또는 비밀번호가 올바르지 않습니다.
            </div>
            <div th:if="${param.logout}" class="alert alert-success" role="alert" style="text-align:center;">
                로그아웃되었습니다.
            </div>

            <label class="field" aria-label="아이디">
                <input id="username" name="username" type="text" inputmode="email"
                       placeholder="아이디(이메일 또는 사용자명)" required />
            </label>
            <div>
                <label class="field" aria-label="비밀번호">
                    <input id="password" name="password" type="password"
                           placeholder="비밀번호" required
                           autocomplete="current-password" />
                    <button type="button" class="eye-btn" id="togglePw" aria-label="비밀번호 표시 전환">
                        <svg id="eyeOpen" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"/><circle cx="12" cy="12" r="3.5"/></svg>
                        <svg id="eyeClosed" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M17.94 17.94C16.14 19.24 14.19 20 12 20 5 20 1 12 1 12a20.1 20.1 0 0 1 6.06-6.06M22.99 12s-1.13 2.16-3.18 4.16M3 3l18 18"/></svg>
                    </button>
                </label>
                <div id="capsHint" class="hint" role="alert" aria-live="polite" style="display:none;">
                    Caps Lock이 켜져 있습니다.
                </div>
                <hr style="border: none; border-top: 2px solid var(--border); margin-top: 12px; margin-bottom: 0;" />
            </div>

            <div class="actions">

                <button class="btn" type="submit">로그인</button>

                <div class="social-login-buttons">
                    <a th:href="@{/oauth2/authorization/kakao}" class="btn kakao-btn">
                        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 20px; height: 20px; margin-right: 8px;">
                            <path d="M16 4.66666C9.17933 4.66666 3.66602 8.84132 3.66602 14.04C3.66602 17.6533 6.13002 20.8193 9.61335 22.518L8.10602 27.026C7.99068 27.3887 8.35668 27.696 8.68735 27.52L13.79 24.834C14.502 24.938 15.236 24.992 16 24.992C22.8207 24.992 28.334 20.8173 28.334 15.618C28.334 10.4187 22.8207 6.24399 16 6.24399C16 4.66666 16 4.66666 16 4.66666Z" fill="#191919"/>
                        </svg>
                        카카오 로그인
                    </a>

                    <a th:href="@{/oauth2/authorization/naver}" class="btn naver-btn">
                        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 20px; height: 20px; margin-right: 8px;">
                            <path d="M16.278 18.156V25.667H9.5V6.33301H16.278V13.844H22.5V6.33301H22.501V25.667H22.5V18.156H16.278Z" fill="white"/>
                        </svg>
                        네이버 로그인
                    </a>

                    <a th:href="@{/oauth2/authorization/google}" class="btn google-btn">
                        <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" style="width: 20px; height: 20px; margin-right: 8px;">
                            <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"/>
                            <path fill="#FF3D00" d="m6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"/>
                            <path fill="#4CAF50" d="m24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"/>
                            <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-0.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.612 34.627 44 30.032 44 24c0-1.341-.138-2.65-.389-3.917z"/>
                        </svg>
                        구글 로그인
                    </a>
                </div>
            </div> <div class="links" aria-label="바로가기">
            <a th:href="@{/signup}" id="link-signup">회원가입하기</a><span>·</span>
            <a href="#" id="link-find-id">아이디 찾기</a><span>·</span>
            <a href="#" id="link-find-pw">비밀번호 찾기</a>
        </div>

        </form>
    </div>
</main>

<script>
    // 비밀번호 보기/숨기기
    const pw = document.getElementById('password');
    const toggle = document.getElementById('togglePw');
    const eyeOpen = document.getElementById('eyeOpen');
    const eyeClosed = document.getElementById('eyeClosed');

    toggle.addEventListener('click', () => {
        const show = pw.type === 'password';
        pw.type = show ? 'text' : 'password';
        eyeOpen.style.display = show ? 'none' : 'block';
        eyeClosed.style.display = show ? 'block' : 'none';
        pw.focus({ preventScroll:true });
        const v = pw.value; pw.value = ''; pw.value = v;
    });

    // Caps Lock 감지
    const capsHint = document.getElementById('capsHint');
    const updateCaps = (e) => {
        const isCaps = e.getModifierState && e.getModifierState('CapsLock');
        capsHint.style.display = isCaps ? 'block' : 'none';
    };
    pw.addEventListener('keydown', updateCaps);
    pw.addEventListener('keyup', updateCaps);
    pw.addEventListener('focus', (e)=>updateCaps(e));
    pw.addEventListener('blur', ()=> capsHint.style.display='none');
</script>
</body>
</html>
