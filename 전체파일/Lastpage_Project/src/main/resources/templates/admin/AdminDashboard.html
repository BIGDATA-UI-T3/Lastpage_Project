<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 대시보드</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/adminDashboard.css}">

    <style>
    </style>

</head>
<body>
<div class="header-wrapper">
    <div id="header-container"></div>
</div>
<!-- 관리자 헤더 -->
<div class="admin-header">
    관리자 대시보드
</div>

<div class="admin-layout">

    <!-- 좌측 메뉴 -->
    <div class="sidebar">
        <a href="/admin/dashboard"> 대시보드</a>
        <a href="/admin/users"> 사용자 관리</a>
        <a href="/admin/reserves"> 예약 관리</a>
        <a href="/admin/qna"> QnA 관리</a>
    </div>

    <!-- 메인 -->
    <div class="main-content">

        <!-- 요약 카드 5개 -->
        <div class="row g-3 mb-4">
            <div class="col-md-3">
                <div class="summary-card">
                    <div>총 회원 수</div>
                    <div class="summary-number" th:text="${userCount}">0</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="summary-card">
                    <div>심리 상담 예약</div>
                    <div class="summary-number" th:text="${psyCount}">0</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="summary-card">
                    <div>굿즈 예약</div>
                    <div class="summary-number" th:text="${goodsCount}">0</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="summary-card">
                    <div>장례 예약</div>
                    <div class="summary-number" th:text="${funeralCount}">0</div>
                </div>
            </div>

            <div class="col-md-3 mt-3">
                <div class="summary-card">
                    <div>QnA 문의</div>
                    <div class="summary-number" th:text="${qnaCount}">0</div>
                </div>
            </div>
        </div>


        <!-- 최근 가입자 -->
        <h4 class="mt-4"> 최근 가입자 5명</h4>
        <table class="table table-sm table-bordered mt-2">
            <thead>
            <tr>
                <th>이름</th>
                <th>아이디</th>
                <th>가입일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="u : ${recentUsers}">
                <td th:text="${u.name}">홍길동</td>
                <td th:text="${u.id}">hong</td>
                <td th:text="${#temporals.format(u.created_at,'yyyy-MM-dd')}">2025-11-16</td>
            </tr>
            </tbody>
        </table>


        <!-- 최근 QnA -->
        <h4 class="mt-5"> 최근 문의 5건</h4>

        <table class="table table-sm table-bordered mt-2">
            <thead>
            <tr>
                <th>제목</th>
                <th>작성자</th>
                <th>등록일</th>
            </tr>
            </thead>
            <tbody>

            <tr th:each="q : ${recentQna}">
                <!-- 제목 -->
                <td th:text="${q.title}">문의 제목</td>

                <!-- 작성자: 닉네임 → 없으면 회원명 → 둘 다 없으면 익명 -->
                <td th:text="${q.nickname != null && !#strings.isEmpty(q.nickname)
                        ? q.nickname
                        : (q.user != null && !#strings.isEmpty(q.user.name)
                            ? q.user.name
                            : '익명')}">
                    익명
                </td>

                <!-- 날짜 -->
                <td th:text="${#temporals.format(q.createdAt,'yyyy-MM-dd')}">2025-11-17</td>
            </tr>

            </tbody>
        </table>




        <!-- 최근 심리 상담 -->
        <h4 class="mt-5"> 최근 심리 상담 예약</h4>
        <table class="table table-sm table-bordered mt-2">
            <thead>
            <tr>
                <th>예약자</th>
                <th>예약일</th>
                <th>시간</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="p : ${recentPsy}">
                <td th:text="${p.name}"></td>
                <td th:text="${p.consultDate}"></td>
                <td th:text="${p.time}"></td>
            </tr>
            </tbody>
        </table>


        <!-- 최근 굿즈 예약 -->
        <h4 class="mt-5"> 최근 굿즈 예약</h4>
        <table class="table table-sm table-bordered mt-2">
            <thead>
            <tr>
                <th>예약자</th>
                <th>상품</th>
                <th>예약일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="g : ${recentGoods}">
                <td th:text="${g.ownerName}"></td>
                <td th:text="${g.product}"></td>
                <td th:text="${g.targetDate}"></td>
            </tr>
            </tbody>
        </table>


        <!-- 최근 장례 예약 -->
        <h4 class="mt-5"> 최근 장례 예약</h4>
        <table class="table table-sm table-bordered mt-2">
            <thead>
            <tr>
                <th>보호자</th>
                <th>펫 이름</th>
                <th>예약일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="f : ${recentFuneral}">
                <td th:text="${f.ownerName}"></td>
                <td th:text="${f.petName}"></td>
                <td th:text="${f.funeralDate}"></td>
            </tr>
            </tbody>
        </table>

    </div>

</div>
<div id="footer-container"></div>
<script src="/js/header.js"></script>
<script src="/js/footer.js"></script>
</body>
</html>
