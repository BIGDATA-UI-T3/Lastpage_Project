<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/psy_reserve.css}">
    <title>심리상담 예약</title>
</head>
<body th:data-userseq="${sessionUserSeq}"
      th:data-mode="${mode}"
      th:data-id="${reserve != null ? reserve.id : ''}">
<div class="header-wrapper">
    <div id="header-container"></div>
</div>
    <main>
    <!-- 메인 -->
    <div class="wrap">
        <div class="card">
            <div class="steps" aria-label="예약 단계">
                <div class="step-dot active" id="dot1"></div>
                <div class="step-dot" id="dot2"></div>
                <div class="step-dot" id="dot3"></div>
                <div class="step-dot" id="dot4"></div>
            </div>
            <h1 class="title" id="formTitle"
                th:text="${mode == 'edit' ? '심리상담 예약 수정' : '심리상담 예약'}">심리상담 예약</h1>

            <!-- STEP 1 -->
            <section class="step active" id="step1">
                <div class="grid">
                    <div>
                        <label class="small">예약자명</label>
                        <div class="field">
                            <input id="name" type="text" placeholder="홍길동"
                                   th:value="${reserve != null ? reserve.name : ''}" required>
                        </div>
                    </div>
                    <div>
                        <label class="small">생년월일</label>
                        <div class="field">
                            <input id="birth" type="date" th:value="${reserve != null ? reserve.birth : ''}" required>
                        </div>
                    </div>
                    <div>
                        <label class="small">성별</label>
                        <div class="field">
                            <select id="gender" required>
                                <option value="">선택</option>
                                <option value="F" th:selected="${reserve != null and reserve.gender == 'F'}">여</option>
                                <option value="M" th:selected="${reserve != null and reserve.gender == 'M'}">남</option>
                                <option value="N" th:selected="${reserve != null and reserve.gender == 'N'}">선택안함</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="small">휴대폰번호</label>
                        <div class="field">
                            <input id="phone" type="tel" inputmode="numeric" placeholder="01012345678"
                                   th:value="${reserve != null ? reserve.phone : ''}" required>
                        </div>
                    </div>
                    <div>
                        <label class="small">이메일</label>
                        <div class="field">
                            <input id="email" type="email" placeholder="name@example.com"
                                   th:value="${reserve != null ? reserve.email : ''}" required>
                        </div>
                    </div>
                    <div>
                        <label class="small">집주소</label>
                        <div class="field">
                            <input id="address" type="text" placeholder="시/구/동, 상세 주소"
                                   th:value="${reserve != null ? reserve.address : ''}" required>
                        </div>
                    </div>
                </div>
                <div class="actions">
                    <button id="next1" class="btn primary" type="button" disabled>다음</button>
                </div>
            </section>

            <!-- STEP 2 -->
            <section class="step" id="step2">
                <div class="grid">
                    <div>
                        <label class="small">상담 날짜</label>
                        <div class="field">
                            <input id="consultDate" type="date"
                                   th:value="${reserve != null ? reserve.consultDate : ''}" required>
                        </div>
                    </div>
                    <div>
                        <label class="small">상담사</label>
                        <div class="field">
                            <select id="counselor" required>
                                <option value="">상담사 선택</option>
                                <option value="손보금" th:selected="${reserve != null and reserve.counselor == '손보금'}">손보금 상담사</option>
                                <option value="박준형" th:selected="${reserve != null and reserve.counselor == '박준형'}">박준형 상담사</option>
                                <option value="심예진" th:selected="${reserve != null and reserve.counselor == '심예진'}">심예진 상담사</option>
                                <option value="보동이" th:selected="${reserve != null and reserve.counselor == '보동이'}">보동이 상담사</option>
                                <option value="금동이" th:selected="${reserve != null and reserve.counselor == '금동이'}">금동이 상담사</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="grid-1" style="margin-top:10px">
                    <div>
                        <label class="small">상담 시간 (1시간)</label>
                        <div id="timeSlots" class="slots" role="listbox" aria-label="상담 시간 선택"
                             th:data-time="${reserve != null ? reserve.time : ''}"></div>
                    </div>

                    <div>
                        <label class="small">메모 (선택)</label>
                        <div class="field" style="align-items:start">
                            <textarea id="memo" rows="4" maxlength="300"
                                      th:text="${reserve != null ? reserve.memo : ''}"
                                      placeholder="본인의 심리상태를 자세하게 적어주시면 상담시 도움이됩니다."></textarea>
                        </div>
                        <div class="count"><span id="memoCount">0</span>/300</div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn secondary" type="button" id="prev2">이전</button>
                    <button id="next2" class="btn primary" type="button" disabled>다음</button>
                </div>
            </section>

            <!-- STEP 3 -->
            <section class="step" id="step3">
                <div class="grid-1">
                    <div class="field" style="justify-content:center"><strong>입력한 예약 내용을 확인해 주세요.</strong></div>
                    <div class="summary" id="summary"></div>
                    <label class="field" style="gap:10px">
                        <input type="checkbox" id="confirmChk" style="margin:0 0;" />
                        <span>입력한 내용이 정확합니다.</span>
                    </label>
                </div>
                <div class="actions">
                    <button class="btn secondary" type="button" id="prev3">이전</button>
                    <button id="next3" class="btn primary" type="button" disabled>다음</button>
                </div>
            </section>

            <!-- STEP 4 -->
            <section class="step" id="step4">
                <div class="grid-1">
                    <div class="field" style="justify-content:center">
                        <strong id="finalTitle"
                                th:text="${mode == 'edit' ? '예약 수정이 완료되었습니다.' : '예약 요청이 완료되었습니다.'}">
                            예약 요청이 완료되었습니다.
                        </strong>
                    </div>
                    <div class="summary" id="finalSummary"></div>
                </div>

                <div class="actions">
                    <button class="btn secondary" type="button" id="prev4">이전</button>
                    <button class="btn submit-btn" id="submitBtn" type="button">제출하기</button>
                </div>
            </section>
        </div>
    </div>
</main>
    <div id="footer-container"></div>
    <script src="/js/header.js"></script>
    <script src="/js/footer.js"></script>
    <script src = "/js/psyReserve.js"></script>
</body>
</html>
