<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원정보 수정</title>
    <!--https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css 사진 집어넣고 싶으면 나중에 넣어보기!!! -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/EditInfo.css}">
    <style>
    </style>
</head>

<div class="header-wrapper">
    <!-- 헤더 -->
    <header>

        <!-- 햄버거 -->
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <!-- 사이드 메뉴 -->
        <div class="side-menu" id="sideMenu">
            <ul>
                <li><a href="#">홈</a>
                    <ul>
                        <li><a href="#">인사말</a></li>
                    </ul>
                </li>
                <li><a href="#">장례서비스</a></li>
                <li><a href="#">Ourpage</a></li>
                <li><a href="#">커뮤니티</a></li>
                <li><a href="#">심리상담</a>
                    <ul>
                        <li><a href="#">상담예약</a></li>
                        <li><a href="#">예약조회</a></li>
                    </ul>
                </li>
                <li><a href="#">추모굿즈</a>
                    <ul>
                        <li><a href="#">굿즈소개</a></li>
                        <li><a href="#">굿즈예약</a></li>
                        <li><a href="#">예약조회</a></li>
                    </ul>
                </li>
                <li><a href="#">마이페이지</a></li>
                <li><a href="#">고객센터</a></li>
            </ul>
        </div>




        <div class="logo">
            <a href="#"><img src="../Asset/LastPage로고_투명.png" alt="로고" /></a>
        </div>
        <nav>
            <ul>
                <li>
                    <a href="#">홈</a>
                    <ul>
                        <li><a href="#">인사말</a></li>
                    </ul>
                </li>

                <li><a href="#">장례서비스</a></li>
                <li><a href="#">Ourpage</a></li>
                <li><a href="#">커뮤니티</a></li>
                <li>
                    <a href="#">심리상담</a>
                    <ul>
                        <li><a href="#">상담예약</a></li>
                        <li><a href="#">예약조회</a></li>
                    </ul>
                </li>

                <li>
                    <a href="#">추모굿즈</a>
                    <ul>
                        <li><a href="#">굿즈소개</a></li>
                        <li><a href="#">굿즈예약</a></li>
                        <li><a href="#">예약조회</a></li>
                    </ul>
                </li>
                <li><a href="#">마이페이지</a></li>
                <li><a href="#">고객센터</a></li>
            </ul>
        </nav>
        <div class="auth"
             th:data-login="${session.loginUser != null ? 'true' : 'false'}"
             th:data-username="${session.loginUser != null ? session.loginUser.name : ''}">
            <a href="/signin" class="login-link">로그인</a>
            <a href="/signup" class="signup-link">회원가입</a>
        </div>
    </header>
<body>

<div class="container">
    <h2>회원정보 수정</h2>

    <form id="editForm">
        <div class="mb-3">
            <label class="form-label">이름</label>
            <input type="text" id="name" class="form-control" placeholder="홍길동" th:value="${member?.name}">
        </div>

        <div class="mb-3">
            <label class="form-label">이메일</label>
            <input type="email" id="email" class="form-control" placeholder="example@gmail.com" th:value="${member?.email}">
            <div class="muted">이메일은 변경할 수 없습니다.</div>
        </div>

        <div class="mb-3">
            <label class="form-label">비밀번호</label>
            <input type="password" id="password" class="form-control" placeholder="비밀번호 변경 시 입력">
        </div>

        <div class="mb-3">
            <label class="form-label">비밀번호 확인</label>
            <input type="password" id="password-confirm" class="form-control" placeholder="비밀번호 확인">
        </div>

        <div class="mb-3">
            <label class="form-label">휴대폰 번호</label>
            <input type="tel" id="phone" class="form-control" placeholder="010-1234-5678" th:value="${member?.phone}">
        </div>

        <div class="mb-3">
            <label class="form-label">생년월일</label>
            <input type="date" id="birth" class="form-control" th:value="${member?.birth}">
        </div>

        <div class="mb-3">
            <label class="form-label">성별</label>
            <select id="gender" class="form-select" th:value="${member?.gender}">
                <option value="">선택</option>
                <option value="M">남성</option>
                <option value="F">여성</option>
                <option value="N">선택안함</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">주소</label>
            <input type="text" id="address" class="form-control" placeholder="시/구/동, 상세 주소" th:value="${member?.address}">
        </div>

        <button type="button" class="btn-save" id="saveBtn">저장하기</button>



    </form>
</div>

<!-- 푸터 -->
<footer>
    대충 연락처 / GitHub 주소 / 이메일 등 입력 예정/ 푸터 높이는 헤더 배너 반응 테스트용.
</footer>
<script>
    document.getElementById('saveBtn').addEventListener('click', async () => {
      const member = {
        name: document.getElementById('name').value.trim(),
        email: document.getElementById('email').value.trim(),
        password: document.getElementById('password').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        birth: document.getElementById('birth').value,
        gender: document.getElementById('gender').value,
        address: document.getElementById('address').value.trim()
      };

      const res = await fetch('/member/update', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(member)
      });

      if (res.ok) {
        alert('회원정보가 수정되었습니다.');
        window.location.href = '/mypage/Mypage';
      } else {
        alert('회원정보 수정 중 오류가 발생했습니다.');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
    const authDiv = document.querySelector(".auth");
    const isLoggedIn = authDiv.dataset.login === "true";
    const username = authDiv.dataset.username;
    const loginLink = authDiv.querySelector(".login-link");
    const signupLink = authDiv.querySelector(".signup-link");



 if (isLoggedIn) {
 // 로그인 상태 → "누구누구님 반갑습니다"로 교체
    loginLink.textContent = `${username}님 반갑습니다.`;
    signupLink.textContent = "로그아웃";
          loginLink.href = "/mypage/Mypage";
          signupLink.href = "/logout";


  }
});
(function () {
  const header = document.querySelector('header');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 200) {
      header.style.top = '-120px';
    } else {
      header.style.top = '0';
    }
  });
})();

<!--// ScrollSpy 강제 초기화-->
<!--document.addEventListener("DOMContentLoaded", function () {-->
<!--  new bootstrap.ScrollSpy(document.body, {-->
<!--    target: '#list-example',-->
<!--    offset: 100-->
<!--  });-->
<!--});-->

const hamburger = document.getElementById('hamburger');
const sideMenu = document.getElementById('sideMenu');

hamburger.addEventListener('mouseenter', () => {

  sideMenu.classList.add('open');
});

sideMenu.addEventListener('mouseleave', () => {
  sideMenu.classList.remove('open');
});
</script>
</body>
</html>
